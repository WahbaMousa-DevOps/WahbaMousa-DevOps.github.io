name: Deploy to Staging

on:
  workflow_run:
    workflows: ["CI Pipeline"]
    types:
      - completed
    branches: # only when open pr on main and if use separate branch from main mention here also mention this branch in branch protection, to make sure that next step on prod 100%.
      - main

jobs:
  deploy-staging:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    name: Deploy to Staging Preview
    runs-on: ubuntu-latest
    environment:
      name: staging
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Build for Staging
        run: |
          echo "Build and deploy to staging preview"
          # build command here, or Jekyll if static

      - name: Upload Pages Artifact
        uses: actions/upload-pages-artifact@v3

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
