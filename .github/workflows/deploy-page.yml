name: Deploy GitHub Pages # has no effect change with actions/deploy-pages@v4 step

on:
  # workflow_run:  # disable this because if active will overwrite staging temporary CNAME file and cannot reach staging website to check. Note after trigger this flow manually staging site CNAME will be overwritten.
  #   workflows: ["Deploy to Staging"]  
  #   types: [completed]
  #   branches: [main]
    #  just a trigger that tells GitHub to run deploy-page.yml after those workflows finish. It does not replace branch protection rules. Branch protection is enforced by GitHub, not by workflows.
  #  all your workflows (e.g., test.yml, trivy.yml) do run in parallel, and yes, that's good and professional.
  workflow_dispatch: {} # alow manual trigger for workflow run from UI, helpful to give you time to check staging.
  #repository_dispatch: {} #  Allow the workflow to be triggered externally via API (e.g., from another repo or system using a webhook or GitHub API call).

# Prevent concurrent deployments
concurrency:
  group: "pages"
  cancel-in-progress: false

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  deploy:
    #if: ${{ github.event.workflow_run.conclusion == 'success' }} 
    # && github.event_name == 'push' && github.ref == 'refs/heads/main' 
    name: Deploy to GitHub Pages # appear in this work flow main name run
    runs-on: ubuntu-latest
    needs: build
    permissions:
      pages: write
      id-token: write
    environment:
      name: production-github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages # appear under in workflow name
        id: deployment
        uses: actions/deploy-pages@v4 # in action tab under workflow name pages build and deployment "for all this file" this line tell GitHub actually know where to deploy